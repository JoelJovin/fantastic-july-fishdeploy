<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">


    <title>profile with data and skills - Bootdey.com</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- favicon -->
    <link rel="shortcut icon" type="image/png" href="../../img/favicon.png">
    <!-- google font -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,700&display=swap" rel="stylesheet">
    <!-- fontawesome -->
    <link rel="stylesheet" href="../../css/homepage/profile.css">
    <link rel="stylesheet" href="../../css/all.min.css">
    <!-- bootstrap -->
    <link rel="stylesheet" href="../../bootstrap/css/bootstrap.min.css">
    <!-- owl carousel -->
    <link rel="stylesheet" href="../../css/owl.carousel.css">
    <!-- magnific popup -->
    <link rel="stylesheet" href="../../css/magnific-popup.css">
    <!-- animate css -->
    <link rel="stylesheet" href="../../css/animate.css">
    <!-- mean menu css -->
    <link rel="stylesheet" href="../../css/meanmenu.min.css">
    <!-- main style -->
    <link rel="stylesheet" href="../../css/main.css">
    <!-- responsive -->
    <link rel="stylesheet" href="../../css/responsive.css">
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <link
    href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
    integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
    crossorigin="anonymous" referrerpolicy="no-referrer">
</head>

<body>
    <!-- header -->
    <div class="top-header-area" id="sticker">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 col-sm-12 text-center">
                    <div class="main-menu-wrap">
                        <!-- logo -->
                        <div class="site-logo">
                            <a href="../../../index.html">
                                <img src="../../img/logo.jpg" alt="">
                            </a>
                        </div>
                        <!-- logo -->

                        <!-- menu start -->
                        <nav class="main-menu">
                            <ul>
                                <li class="current-list-item"><a href="../../../index.html">Home</a></li>
                                <li><a href="about.html">About</a></li>
                                <li><a href="../product/shop.html">Shop</a></li>
                                <li><a href="">Order</a></li>
                                <li><a href="">Contact</a></li>
                                <li>
                                    <div class="header-icons">
                                        <a class="shopping-cart" href="../product/cart.html"><i
                                                class="fas fa-shopping-cart"></i></a>
                                        <button class="login-btn"  id="logOut">Logout</button>
                                    </div>
                                </li>
                            </ul>
                        </nav>
                        <div class="mobile-menu"></div>
                        <!-- menu end -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- end header -->

    <main>

        <div class="header-profile">
            <div class="">
                <h2>Your Profile</h2>
            </div>

            <div class="logout-div">
                <span id="logout" onClick="logOut(event)">Log out</span>
                <i class="fa-solid fa-chevron-right"></i>
            </div>
        </div>

        <div class="account">

            <div class="addressbook">

                <div class="heading">
                    <h5> Address Book</h5>
                </div>

                <!-- <i class="fa-solid fa-location-dot"></i> -->

                <div class="createdAddress">
                    <div class="address_details">
                        <span class="status" >default</span>
                        <div class="address_title">Home</div>
                      
                        <p><strong>House Number:</strong> <span id="house_number"></span></p>
                        <p><strong>Street Name:</strong> <span id="street_name"></span></p>
                        <p><strong>State:</strong> <span id="state"></span></p>
                        <p><strong>Country:</strong> <span id="country"></span></p>
                        <p><strong>Pin Code:</strong> <span id="pin_code"></span></p>
                        
                        <div class="buttons">
                            <div class="edit_address">
                                EDIT
                            </div>
                            <div class="remove_address">
                                REMOVE
                            </div>
                      
                        </div>
                      </div>

                </div>

            </div>



            <div class="profile_details">
                <div class="profile_details_table">

                    <div class="heading">
                        <div>
                            <h3>profile details</h3>
                        </div>

                    </div>

                    <table id="user_data">

                        <caption> </caption>

                        <tr>
                         
                        </tr>
                        <tbody>

                            <tr>
                                <td>Full Name</td>
                                <td id="fullname"></td>
                            </tr>

                            <tr>
                                <td>Mobile Number</td>
                                <td id="mobile_number"></td>
                            </tr>

                            <tr>
                                <td>Email Address</td>
                                <td id="email"></td>
                            </tr>

                        </tbody>
                    </table>
                    <button id="clear">Delete</button>
                </div>
               
            </div>

       
        </div>
    </main>


	<!-- footer -->
	<div class="footer-area">
		<div class="container">
			<div class="row footer-row">
				<div class="col-lg-3 col-md-6">
					<div class="footer-box about-widget">
						<h2 class="widget-title">About us</h2>
						<p>Aazhi fishes, sourced from the depths of the Indian Ocean, offer a taste of maritime excellence and culinary delight.ndulge in the rich flavors of Aazhi fishes, prized for their freshness and unique coastal essence, bringing a symphony of sea to your plate</p>
					</div>
				</div>
				
				<div class="col-lg-3 col-md-6 footer-second-div">
					<div class="footer-box pages">
						<h2 class="widget-title">Pages</h2>
						<ul>
							<li><a href="index.html">Home</a></li>
							<li><a href="about.html">About</a></li>
							<li><a href="services.html">Shop</a></li>
							<li><a href="news.html">News</a></li>
							<li><a href="contact.html">Contact</a></li>
						</ul>
						
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="footer-box subscribe">
						<h2 class="widget-title">Get in Touch</h2>
						<ul>
							<li>No.44/B, Arcot road, nearKodambaakam bridge.</li>
							<li>Next to HDFC Bank, Chennai-24</li>
							<li>+91 70922 34564</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end footer -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {

        
        const email = sessionStorage.getItem('email');
        console.log(email);
        
        if (email) {
            fetch(`/users?email=${encodeURIComponent(email)}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.success) {
                        console.log(data);
                        const user = data.user;
                        console.log(user.id)
                        sessionStorage.setItem('user_id', user.id);

                        document.getElementById('fullname').textContent = user.full_name;
                        document.getElementById('mobile_number').textContent = user.mobile_number;
                        document.getElementById('email').textContent = user.email;

                       
                        const user_id = sessionStorage.getItem('user_id');
                        console.log(user_id);
                        if (user_id) {
                            fetch(`/address?user_id=${encodeURIComponent(user_id)}`)
                                .then(response => {
                                    if (!response.ok) {
                                        throw new Error('Network response was not ok');
                                    }
                                    return response.json();
                                })
                                .then(data => {
                                    if (data.success) {
                                        console.log(data);
                                        document.getElementById('house_number').textContent = data.address.house_number;
                                        document.getElementById('street_name').textContent = data.address.street_name;
                                        document.getElementById('state').textContent = data.address.state;
                                        document.getElementById('country').textContent = data.address.country;
                                        document.getElementById('pin_code').textContent = data.address.pin_code;
                                  
                                        // Handle successful address retrieval here
                                    } else {
                                        alert('Error: ' + data.error);
                                    }
                                })
                                .catch(error => {
                                    console.error('Error:', error);
                                    alert('An error occurred while fetching address data. Please try again.');
                                });
                        } else {
                            alert('User ID not found in sessionStorage.');
                        }
                    } else {
                        alert('Error: ' + data.error);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('An error occurred while fetching user data. Please try again.');
                });
        } else {
            // Handle the case when email is not available
            alert('Email not found in sessionStorage.');
        }
    });

    document.getElementById("logOut").addEventListener("click", function() {
        const email = sessionStorage.getItem('email');
        console.log(email);
    fetch('/logout', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({ email: email }),
  })
  .then(response => {
    if (!response.ok) {
      throw new Error('Network response was not ok');
    }
    return response.json();
  })
  .then(data => {
    if (data.success) {
        window.location.href = 'http://localhost:3000/index';
      console.log(data.message);
    } else {
      console.error(data.error);
    }
  })
  .catch(error => {
    console.error('There was a problem with the fetch operation:', error);
  });
});

document.getElementById("clear").addEventListener("click", function() {
    const email = sessionStorage.getItem('email');
        console.log(email);
    fetch('/clear?email=${encodeURIComponent(email)}`', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({ email: email }),
  })
  .then(response => {
    if (!response.ok) {
      throw new Error('Network response was not ok');
    }
    return response.json();
  })
  .then(data => {
    if (data.success) {
        window.location.href = 'http://localhost:3000/index';
      console.log(data.message);
    } else {
      console.error(data.error);
    }
  })
  .catch(error => {
    console.error('There was a problem with the fetch operation:', error);
  });
});
</script>    
	
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/8.4.5/swiper-bundle.min.js"></script>
    <script src="assets/js/jquery-1.11.3.min.js"></script>
    <!-- bootstrap -->
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <!-- count down -->
    <script src="assets/js/jquery.countdown.js"></script>
    <!-- isotope -->
    <script src="assets/js/jquery.isotope-3.0.6.min.js"></script>
    <!-- waypoints -->
    <script src="assets/js/waypoints.js"></script>
    <!-- owl carousel -->
    <script src="assets/js/owl.carousel.min.js"></script>
    <!-- magnific popup -->
    <script src="assets/js/jquery.magnific-popup.min.js"></script>
    <!-- mean menu -->
    <script src="assets/js/jquery.meanmenu.min.js"></script>
    <!-- sticker js -->
    <script src="assets/js/sticker.js"></script>
    <script src="assets/js/vendor/jquery.nice-select.min.js"></script>
    <!-- main js -->
    <script src="assets/js/main.js"></script>
    <script src="assets/js/profile/index.js"></script>
</body>

</html>